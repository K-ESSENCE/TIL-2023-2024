# File and File System

메모리는 주소를 통해 접근 하는 장치였음

파일은 . 이름을 통해서 접근하는 단위임.

일반적으로 비휘발성의 보조기억장치에 저장함.

데이터 저장 목적만으로만 저장하는게아니라.

운영체제에선 여러가지 장치들도 관리하기위해 file이라는 논리적단위로 볼 수 있도록 해준다.

(서로다른 파일로 관리)=> 디바이스 스페셜 파일이다 라고 부르기도한다.

파일에 대해서 정의되는 연산은 어떤것이있느냐 ? => create, read, write , reposition , delete , open, close

필요에따라 다른 부분부터 읽거나 쓰고싶을때가있을것임

그래서 현제 접근하고 있는 위치를 수정하는게 => repostion (lseek) 라는 연산이 있음

read 나 write를 할려면 open을 하고나서 해야된다라는인터페이스가있음.

open과 close가 왜 굳이 따로 정의가되어있는가?

open의 역할은 디스크에서 메모리로 내용을 올려놓는게 아니라. File 의 메타데이터를 올려놓는 행위를 open이라고한다.

파일에는 파일 자체의 내용말고 그 파일을 관리하기위한 정보가있음.

음악파일이다 하면 파일의 유형 , 위치, 사이즈

## Directory and Logincal Disk

디렉토리 파일의 내용은 무엇인가?

그 디렉토리 밑에 존재하는 파일들이 어떤건지.

그 디렉토리밑에있는 파일의 메타데이터를 내용으로 하고있는게 디렉토리파일이라고함

메타데이터는 파일의 이름을 포함해서 attribute들이 다 메타데이터

디렉토리에 메타데이터를 몽땅 저장할수있지만
일부 메타데이터는 직접 저장하고 일부 메타 데이터는

다른곳에다 저장을 하기도함.

디렉토리에서 저장되는 연산은 뭐가있는가?

search for a file/ create a file/ delete a file

list a directory ,rename a flie , traverse the file system

운영체제가 보는 디스크는 논리적인 디스크임

그리고 이 논리적인 디스크를 다른말로 파디션이라고함.

c드라이브 d드라이브 파티션을 나누면 그 각각이 논리적인 디스크가 되는것.

경우에따라는 물리적인 디스크 여러개를 하나의 파티션으로 구성하기도한다.


파티션 즉 논리적인 디스크에 파일시스템을  설치가능 또는 버츄얼메모리 스왑에어리어로 사용할수도있다

파일시스템,스왑에어리어 용도 두가지로 보통 나눌 수있다.

### open() 

파일의 메타데이터를 메모리로 올려놓는것

메타데이터 중에는 파일의 저장위치도 있음.

open을 하면 시스템콜이니까 cpu제어권이 운영체제로. 운영체제안에는 각프로세스별로 관리하기위한 PCB자료구조가있고

전체 프로그램중 오픈한 파일이 뭔지알수있는 글로벌 테이블이있음.

루트 디렉토리의 메모리데이터를 먼저 메모리에 올림

![image](https://github.com/MAGHC/TIL-2024-/assets/89845540/577c6918-1252-47d6-87ec-95675bd44004)

루트디렉토리의 내용에가면 그중에 a라는 파일의 메타데이터가있을것임 그럼 다시 메모리에 올림

a의메타데이터는 동일하게 위치정보가 저장되어있을것임. 그럼또 컨텐트. 
![image](https://github.com/MAGHC/TIL-2024-/assets/89845540/2d3ff847-446b-4569-ab59-48e54f8510c5)

오픈이라는것은 그파일의 메타데이터를 메모리에 올려놓는작업 

오픈이 끝나면 시스템콜을 했기떄문에 결과값을 리턴하게되는데.

프로세스마다. 프로세스가 오픈한 파일들에 대한 메타데이터 포인터를 가지고있는 일종의 배열

이제부턴 read write를 하게되면 일일이 다시찾을필요가없음. 메모리에 올라가있고 fd가 가지고있기떄문.

버퍼캐시라는걸 운영체제가 가지고있는데

파일시스템의 버퍼캐시는 요청한 내용이 버퍼캐시안에있던 없던 운영체제한테 cpu제어권이넘어가게됨.

나중에 이미 메모리에 있는걸 요청하게되면 시스템콜이기때문에 제어권은 무조건 운영체제에게.

운영체제가 판단하는거.

요청한게있으면 버퍼캐시에서 그냥주고없으면 버퍼캐시에올려놓고.

버퍼캐시에선 자연스럽게 LRU  LFU알고리즘을 사용 

메타데이터를 메모리에 올려놓게되면 추가적으로 이프로세스가 이파일의 어느위치를 접근하고있다는것을 같이가지고있어야됨.

### File Protectroin 

파일에 접근권한 보호 

누구에게 어떤 유형의 접근을 허락할 것인가? 

1.Access control matrix라는 방법

행열에 사용자와 파일이름 나열하고 각각의 파일에 어떤 권한이 있는지.  표시해주는것

Access control list : 파일별로 누구에게 어떤 접근 권한이 있는지 표시 
Capability : 사요아별로 자신이 접근 권한을 가진 파일 및 해당 권한 표시 

2. Grouping

모든 사용자에대해 가지고있는게 아니라 각파일에 대해서  user를 오너 그룹 퍼블릭으로 구분


3. Password
파일마다 password를 두는 방법 (디렉토리 파일에 두는 방법도 가능)
접근 권한별 패스워드 암기, 관리문제.


   
### Access Methods
시스템이 제공하는 파일 정보의 접근방식

예전에는 순차접근 => 카세트 테이프 사용하는거처럼.

직접접근 -> LP레코드 판과 같이 접근 / 임의의 순서로 접근 가능







