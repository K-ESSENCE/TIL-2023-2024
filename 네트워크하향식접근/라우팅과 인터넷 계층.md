# 인터넷 계층의 역할

## IP 어드레스 정보를 보고 데이터를 전달한다.

인터넷 계층은 네트워크 인터페이스 계층과 협력하여 다른 컴퓨터에게 데이터를 전달하는 역할을 한다.

하드웨어에 의존해야 하는 부분을 네트워크 인터페이스 계층이 담당하고, 인터넷 계층은 IP 어드레스라고 하는 식별자 정보를 실마리로 데이터를 전달할 수 있는 체계를 제공하도록 역할이 구분되어있음

## 라우터와 라우팅

데이터를 목적지까지 전달하기 위해서는 라우터라고 하는 네트워크 장비가 필요함. 라우터는 네트워크와 네트워크를 연결하는 역할을 하는데, 하나의 라우터는 데이터를 목적지까지 전달하기 위해 다음 네트워크의 경로를 찾고, 경로상에 있는 라우터에게 데이터 전달을 위임.

이런 연쇄작업으로 목적지의 경로를 찾아 나가는 과정을 라우팅이라고함.

## IP 어드레스와 관련된 여러 기술

인터넷 보급이 급속도로 확산됨에 따라 IP어드레스의 고갈을 방지하기 위한 대안으로 프라이빗 어드레스 와 퍼블릭 어드레스를 구분하는 기법을 사용함.

근본적인 바업으로는 IPv6의 도입이 가속화됨

# IPv4와 IPv6

## IPv4 는 32비트 어드레스

32비트는 사람이 보기 어렵기 때문에 8비트씩 끊어서 10진수로 표현

인터넷 계층에서 사용되는 장비에만 IP 어드레스가 할당된다.

여러 네트워크 장비들 중 네트워크 허브와 같이 네트워크 인터페이스 계층에서 사용되는 장비들에는 IP 어드레스가 할당되지 않음

## IPv4 헤더

버전 / 헤더길이 / 서비스타입 (우선순위 결정)| 패킷 길이

식별자 | 분할 플래그 | 프래그먼트옵셋

생존기간 | 프로토콜(트랜스포트 계층의 어느 프로토콜에 전달할지를 판단하는 번호) | 헤더 쳌섬

송신지 IP 어드레스

수신지 IP 어드레스

옵션설정 | 패딩

## IP 패킷에도 유통기한이 있다.

실제로 존재하지않는 수신지나 통신 경로를 찾지 못한 패킷이 인터넷 네트워크를 떠돌아댕기면 네트워크가 혼잡해질 수 있음으로 이러한 문제를 방지하기 위해 TTL 이 지나면 소멸시키도록 규정

## 좁은 길을 지날 때는 작게 분할해서 지나간다.

한번에 전송할 수 있는 데이터 크기를 MTU 라고 하고 통신 경로의 상태에 따라 달라짐.

라우터에는 MTU 값에 따라 패킷을 분할해서 전송하는 기능이 구현되어 있음. 다만 라우터의 작업 부하가 높거나 분할된 패킷 중의 일부가 유실되면 복원이 어려워지는 단점이 있다.

그래서 라우터가 데이터를 송신하기 전에 통신 경로 전체의 MTU를 살펴본 후 처음부터 MTU 보다 작은 크기의 패킷을 만들도록 설정하기도 함

## 데이터를 분할하고 복원하는 방법

식별자 ⇒ 같은 데이터 값인지 식별하는 16비트 숫자감

분할 플래그 ⇒ 분할 허가 플래그와 이후 남은 분할 부분이 더 있는지 표시하기 위한 플래그

프래그먼트 옵셋 ⇒ 원래 데이터에서의 위치 값을 표현하는 13비트 숫자 값

요는 식별자난 IP어드레스 정보 등을 보고 데이터가 분할된 조각을 모아 복원하는 거

## IPv6

버젼 (여기서는 6)/ 트래픽 클래스(패킷의 우선순위)/ 플로우 레이블

페이로드의 길이/ 다음헤더 / 홉 리미트 (IPv4의 생존 기간과 같은 역할 )

송진지 IP 어드레스

수신지 IP 어드레스

확장 헤더

IPv6는 애당초 라우터에서 데이터를 분할하지 않는 방식으로 사양이 만들어져 있어서 분할 관련 필드는 옵션으로 되어 있음

## IPv6로 갈아타기

듀얼스택 (하나의 장비에 두 종류의 어드레스를 할당한 후, 둘다 사용가능하도록 만듦) / 터널링 IPv4 네트워크를 지나갈 떄 IPv6vozltdmf codnjqhsoa

---

# IP 어드레스의 활용

## 네트워크 부와 호스트 부

IP 어드에스는 네트워크 부 와 호스트 부로 구성된다. 여기서 말하는 호스트는 네트워크에 연결된 컴퓨터나 네트워크 장비를 의미한다.

## 어드레스 클래스

하나의 IP 어드레서 안에서 어디까지가 네트워크 부이고 어디까지가 호스트 부인지 미리 길이를 고정하여 결정해 둔 것이 있는데, 이것을 어드레스 클래스라고 부른다.

아 , a,b,c 클래스이거

0~127 191 224

## 어드레스 클래스의 제약

클래스 A의 어드레스는 한 개의 네트워크당 약 1677만 대의 호스트의 어드레스를 할당할 수 있지만 실제로는 그렇게 많은 호스트를 하나의 네트워크에 연결하는 경우는 없기떄문에 많은 수의 어드레스가 사용되지않고 낭비됨

어드레스 클래스를사용한 네트워크를 좀 더 세분화할 수 있는데 이때 사용하는 것이 서브넷 마스크

## 서브넷 마스크

어드래스 클래스는 네트워크 부의 길이가 미리정해져있다. 하지만 서브넷 마사크를 이용하면 이 길이를 비트 단위로 유연하게 늘려서 쓰는 것이 가능하다.

## IP 어드레스의 할당 방법

IP 어드레스는 네트워크상에서 호스트를 식별하기 위해서 사용됨 그래서전체 32비트중네트워크부를제외한호스트 부 부분만 자유롭게 할당하여 사용할 수 있다.

### 서브넷마스크로 네트워크 세분화하기

서브넷 마스크를 사용하면 네트워크를더 세분화하여 서브 네트워크 ,즉 서브넷을 만들수있다.

서브넷 마스크의 한계 ⇒ 미리 정해진 네트워크부의 길이를 더 늘릴 수는 있지만, 더 줄이지는 못한다. 그래서 이미 호스트 길이가 짧게 만들어진 클래스 C인 경우 남은 8비트 내에서 서브넷 부와 호스트 부로 나누게 되므로 실제로 할당할수 있는호스트 대수가 급격히줄어들게 된다

그 결과 클래스 C에서는 서브넷을 사용하는것이 별 도움이 안됨

그래서 A,B의 어드레스를세분화해야할 때 사용하는것이 일반적임.

## 가정이나 사무실에 자유롭게 사용하는 프라이빗IP 어드레스

프라이빗IP 어드레스는가정이나 사내에서자유롭게사용할수있는 어드레스다.

인터넷이나 다른 네트워크에 연결되지 않아서 주소가 충돌만 나지 않는다면 다른 네트워크에서 사용 중인 어드레스를사용한다 해도 큰 문제는 없다.

다만, 프라이빗 IP 어드레스는인터넷에 연결해도 외부에서 접근할 수없기 떄문에NAT와 같은 어드레스 변환 기술을 사용해서 퍼블릭 IP로 변환해 주는 기법이 필요함.

인터넷에서 접속되어야 하는 서버들은 퍼블릭IP 어드레스가 반드시필요함.

라우터는 프라이빗,퍼블릭 둘다 가지고 있다.

## 퍼블릭IP 어드레스의 관리

퍼블릭은 인터넷 안에서 중복되면 안 되기 때문에 ICANN 이나 KRNI 과 같은 단체가 관리하고 있다.

퍼블릭 IP가 필요하면 각 단체에 신청해서 받아야 함.

### 인터넷 레지스트리

퍼블릭 IP는 인터넷 레지스트리를 통해 인터넷 서비스 제공자들에게 할당되고 기업이나 가정은 인터넷서비스 제공자가확보한 IP 어드레스 들을 빌려서 쓴다.

### 예약된 IP 어드레스

IP 어드레스중에는이미 예약된 특수 목적의 어드레스가 있다.

127.0.0.1은 루프백 어드레스 혹은 로컬호스트라고 부르는데 호스트 자신을가리킨다.

그 외에도 부의 비트를모두 1로 설정한어드레스는 해당 네트워크의 모든호스트들을의미하는 브로드캐스트 어드레스 가된다.

모두 0으로 된 경우는 네트워크 전체를 의미하는 어드레스가된다.

# 라우팅이란

## 라우팅과 경로 탐색

최종 목적지까지 연결되는 경로를 찾을 수있어야 하고 그 과정을 라우팅이라고 하고 이때 찾은 최적의 경로를 사용해서 통신을 하게 된다.

## 라우팅 프로토콜

네트워크 상의 각 라우터는 서로누구와 연결되어 있는지에 대한 정보를교환한다. 이때 사용됨

대표적으로 BGP , OSPF , RIP 등이 있다.

## 자율 시스템

인터넷 서비스 제공자가 사용하는 규모가 큰 네트워크에서는 몇 개의 네트워크를 하나로 묶어 자율 시스템(as)라는 단위로 관리한다. 네트워크의 경로 하나하나를 이동하는 대신 as와 같이 큰 덩어리의 접속 경로 단위로 이동하면 멀리 있는 컴퓨터와도 더 빠른 속도로 통신할 수있다.
