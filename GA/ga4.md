### ga4 setup in next js 13

https://support.google.com/tagmanager/answer/9442095?hl=en

0. 계정 설정

태그 관리자 말고 google 애널리틱스 페이지에서 계정설정부터.

속성이란 실제 웹 사이트를 말함 추적하려고 하는 각 속성

하나의 계정에서 여러 속성을 넣어 추적가능

죽죽 선택하고 만들면 데이터 스트림 설정에서 url 삽입

(데이터를 추적하려면 스트림을 넣어야됨)

향상된 측정은 빼면 성능저하되니까 넣어라

이 다음에 바로 떠는 설치 안내 의 경우 물론 head 에다가 넣으면 잘 작동하지만 웹사이트 전환 추적에 복잡해짐으로 다른 방법을 사용할 것임

내가 보니까 태그 매니저 코드랑 좀 다르게 생김 ga4에서 시작하면 셋업 코드가 윈도우 데이터레이어 부터 시작하고

태그 매니저에서 시작하면 날짜넣는 느낌의 코드 부터 시작됨

1. 기초 셋업

다 했으면

구글 태그 매니저로 ㄱ

구글 태그 매니저는 웹사이트에 여러 태그를 적용하여 다양한 활동 측정

태그 매니저에서도 계정 생성하고 이름 입력 그 다음 셋팅코드 ㄱ

컨테이너에는 url 전체

Script 태그로 감싸고 리터럴 로 처리

<Script>{`...ga제공 head코드`}</Script>

<noscript dangerouslySetInnerHTML={{_html:`<iframe>`}}></noscript>

body에 넣어야되는코드는 dangerouslySetInnerHTML로 셋팅

dangerouslySetInnerHTML? => innerHTML 이랑 비슷
DOM에서 innerHTML을 사용하기 위한 React의 대체 방법
innerHTML을 사용하면 DOM노드가 수정되었을때 수정된 것을 알 수 있는 방법이 없다
하지만 이 dangerously~ 를 쓰면 가상 DOM과 실제 DOM을 비교하여 변경된 것이 있다면 리렌더링이 될 수 있도록 함

\*주의사항 : XSS 공격 위험: dangerouslySetInnerHTML을 사용하여 사용자로부터 입력받은 값을 직접적으로 렌더링할 경우, XSS 공격에 취약해질 수 있습니다. 이런 공격은 악의적인 스크립트가 웹 애플리케이션에 삽입되어 다른 사용자들에게 영향을 미칠 수 있다.

아하 가짜폼 삽입 같이 돔 건드려서 하는 것을 이야기하나 보네

아무튼 여기까지 다 됬으면 구글 태그 매니저 관리자에는 연결이 되었으나 애널리틱스에는 연결이 안된 상태

태그 관리자를 애널리틱스에 연결하려면

태그 매니저의 태그 메뉴로 가서 새로만들기

태그 유형 구글 태그 => 이게 원래는 ga4 셋업 이 있었는데 하나로 합쳐짐

태그 ID ?=> ga 애널리틱스에있는 측정 ID

만일 ga 페이지 안보인다 => admin으로 들어가서 데이터 스트림 들어가면 우리가 만든 스트림 볼 수 있음

트리거 하나 설정 => init 모든 페이지 선택 => 웹사이트 조회 될때마다 태그 매니저에게 태그를줘서 애널리틱스에서 추적할 수 있게 함

태그 이름으로 ga4 Tag-측정 id로 보기쉽게참고용 하고 오른쪽 상단에 submit 해줘야됨

하면 듣는 사람이없는것처럼 노래를 부르라는 로딩이뜸

태그 1 변수 5 나옴

그리고 새로고침하고 다시 ga 애널리틱스 쪽으로 가면 사람있는거 볼 수 있...?

없는데

맨처음에 재끼라고 한 head 코드랑 같이 넣어줘야 되는듯

유의 해야될건 두개 아이디가 다름

### 트래픽 부풀리기 막기

모든 페이지 뷰에 들어갈때마다 카운트가 올라간다.

이건 정확한 데이터가 아니기 때문에. 이런 데이터를 원하지는 않을것이다.

내부적인 트래픽은 분석에서 제외되는게 좋다.

관리자 화면=> 데이터 스트림

태그 설정 구성으로 가서 자세히보기 => 내부 트래픽 정의

그리고 내 아이피주소 넣으면됨

데이터 수집 및 수정에 데이터 필터 , 해서 내부필터

내부 필터 연산 동작은 제외로

마지막으로 테스트를 액티브로

직원들의 아이피는 다막고싶으면 같은작업을 계속해야됨

아 사용자가 올라가는건 그대로이고 말그대로 트래픽에서의 보고서를 막아주나 보네

### 데모 컨텐츠 접근

ga에 익숙해지고 실제 데이터를 사용해 실전 경험하는 좋은방법은 ga 데모 계정을 사용하는것 이다

구글에서 자기네들 구글 숍 팬 판매사이트 같은거 열어놔주는거 있음

google analytics demo account 검색

https://support.google.com/analytics/answer/6367342?hl=en#zippy=%2Cin-this-article

access 로 가서 확인 가능

그러면 스토어의 모든 데이터를 볼 수 있다

ㅇ 추가되네

### 구글 애널리틱스 대시보드

현재 웹 사이트에 몇명의 사용자가 있는지 분류별로 볼 수 있음

실시간으로 진행되는 마케팅 같은게있다면 유용하게 사용 가능

획득 참여도 수익창출

획득 보고서는 마케팅 채널의 성능을 보는 데 사용이 된다.

어디로 오는 지 볼수있음 세션 기본 채널 그룹이 어디서오는지네 direct/ search/ email/ social

어떻게 들어오는지보고 싶다 -> 획득보고서

참여도 보고서=> 사람들이 우리의 웹사이트나 앱과 어떻게 상호작용하는지 보여줌

사람들이 페이지 사이를 어떻게 이동하는지

어디가 가장 인기있는지 어떤 페이지를 통해 들어오는지

전환 데이터도 볼 수있음 어떤 페이지가 얼마나 많은 전환을 일궈 내는지

수익창출 : 웹사이트에스토어가있다면 모든 판매관련활동은 여기에서 생성이된다.

이커머스 스토어가 없다면 그닥 필요하진 않음

사용자 보고서 에는 두가지 종류가있다.

인구 보고서 : 사용자들이 누구인지 어느 국가에서 왔고 뭐에 관심이있고 나이는 몇인지

기술 보고서 : 웹사이트에 접속할때 사용하는 기술에 대해서 적혀있음 , 어떤 기기 데탑 ,컴퓨터 , 모바일 ,아이패드

탐색 의 경우 방금 표준 보고서 뒤에서 일어나는 고급 기술들의 모음

마지막은 광고

광고를 쓰고있다면 유용하게 사용할 것임 진행하고있는 광고에 대해 많은 정보를 가져옴

어디서 가장 많은 채널 전환이 이루어지는 등을 알 수 있다.

마케팅 활동에 대해 더 나은 ROI 를 만들고자 특정 광고 채널에 예산을 할당하는 데 도움이 될것임
ROI return on invesetment 투자 대비 수익률

보통은 두번째가 우리가 원하는 대부분의 정보가 있다

80- 20 의 법칙 / 20%의 분석데이터로 80%의 효율을 낸다

그냥 검색바에다가 지난주 내 웹사이트 검색률 같은거 써도 나옴

### 데이터 분석

1. 트래픽 량 파악하는 방법

웹 사이트를 몇명이 봤는지 보려면 보고서 => 획득 보고서 웹에 사용자가 어떻게 들어왔는지 => 설정된 기간동안 얼마나 들어왔는지 인사이트를 보여줌
![Alt text](image.png)

2. 유저 파악하는방법

이전에 말했던 거랑 같은데 개요 말고 세부사항을 보면 어느나라에서 가장많이 사용하는지 등을 볼 수 있다.

### 사이트 내 최고 인기 페이지 탐색하는 방법

참여도 에서 확인 가능

페이지및 화면에서 어디가 제일 인기있는지등을 볼 수 있다.

탐색 => 탐색 분석 => 일반보고서 에 비해 더 상세한 인사이트 => 자유 형태로 해서 날짜 바꾸고 방문한 사람들이 웹사이트를 떠나기 전에 어떤 페이지를 보고 싶은지 에 대한 것을 보고 싶다. => 세그먼트 (사용자의 부분 집합) 설정

측정 기준: 데이터의 속성 (남/여 특정국가인 , 아이폰 등등)

구글에서는 사용자피드백을 통해서 측정기준을 넣었다 뻈다 함

아무튼 거기서 찾고싶은 페이 제목 및 스크린 클래스를 선택하고 가져오기 하면 된다.

나가는 사용자 대비 들어오는 사용자의 숫자를 보고 싶다고 하면 어떤 페이지를 보는지 검색해서 찾을 수 있다.

오른쪽 차트가 업데이트 되게 하려면 지역기준을 지워버리고 측정기준을 가져오도록 설정하면됨
![Alt text](image-2.png)

벨류로 가서 이탈, 방문자수 넣고 리포트 만들면되는거 별거없네

- 어디서 왔는 지 상세하게 보는법

![Alt text](image-1.png)

저기를 바꾸면 된다

오가닉은 검색
cpc 는 그거 클릭 해서 온거

실시간 보고서의 경우 일이 계획대로 진행되고있는지에 대한것을 볼 수 있다.

### DAU MAU WAU

DAU: 일일 활성 사용자

WAU: 주간 활성 사용자

MAU : 월간 활성 사용자

일간사용자를 월간사용자로 나누면 지난 24시간의 참여도를 알수있는 등의 사용을 함

참여도의 개요를 보면 맨아래에 나옴
![Alt text](image-3.png)

### 이벤트와 전환

ga는 이벤트와 전환이라는 큰 토픽이 있다.

이벤트? => 사용자가 웹사이트나 앱과 상호작용할때 촉발됨

기본값으로 향상된 뭐시기 킨게 바로 그것임

셋팅의 이벤트로 가서 도 볼 수 있음

전환은 비즈니스의 성공에 기여하는 완료된 활동을가리킴 (뭐사거나 그런거겠지)

누군가에게는 폼 제출 , 누군가에게는 전화클릭 , 등등이 있다.

가치가 있는 사용자의 웹사이트에 대한 구체적인 행동을 말함

그래서 이벤트에서 설정할수있다. 어떤 이벤트를 전환으로 간주할 것인가

태그는 : GA로 전송하는 코드고

트리거는 : 언제 애널리틱스에 전송할지를 결정하는 액션

원하는 만큼 태그를 생성할 수 있지만 트리거가 가장 중요한것이 될것임

트리거를 잘못 설정하면 태그를 몇 개나 만들 던지 계정에 안날라감

event name의 경우 구글에서 명명하는걸로 지어야 애널리틱스에서 더욱 쉽게 식별 가능하다

웹사이트로 오는 각각의 문의에 값을 할당하고자한다면 이벤트 매개변수로가서

행을 추가하면 됨
![Alt text](image-4.png)

마지막으로 고급 세션으로 가서 태그 촉발 옵션을 이벤트당 한번에서 페이지당 한번으로 변경

트리거 구성 + => 페이지 뷰

페이지 호스트 네임 => member/login 아무튼 뒤에있는거 따옴

오 뭐야 테스트가있네

제출 옆에 테스트 누르고 검사할 페이지 연결

하고 원래 하던 페이지로 가면 파비콘이 깜빡임

적용후 보고서에 드러나기까지는 시간이 24~48시간 가량 걸림
