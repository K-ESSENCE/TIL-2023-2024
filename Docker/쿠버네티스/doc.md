## 개요

사용하는 클라우드 프로바이더와 관계없이 컨테이너 오케스트레이션과 대규모 배포에 도움되는 도구
애플리케이션의 배포, 확장 및 관리를 자동화하기위한 오픈소스 시스템
단일 소프트웨어 가아니라 시스템
컨테이너 배포에 도움이되는 도구 및 작업 방법의 모음임

### 컨테이너 수동 배포의 문제점

컨테이너가 충돌하거나 다운될수있음. => 컨테이너 화된 앱 내부에서.

수동으로 배포하게되면 충돌할떄마다 수동으로 모니터링하고 수동으로 컨테이너를 재시작해야됨

하루종일 로그를 보고 매번 재시작할수는없음.

그런게 아니더라도 트래픽 증가시 더 많은 인스턴스가 필요함.

동일한 이미지의 컨테이너를 기반으로 원하는 만큼 컨테이너를 실행할 수 있음 이것으로 더 많은 수신 트래픽 및 워크로드를 처리하기에 충분해짐.

### why kubernetes?

ECS 는 컨테이너 상태를 자동으로 확인 => 충돌시 재시작
ECS도 오토스케일링에 도움이 됨. => 들어오는 트래픽 급증을 자동 처리
로드 밸런서 => 변경되지않는 IP주소및 도메인 제공 + 균등 분할

provider를 다른애들로 변경할려고하면 변경 불가 ECS 에서 썼기떄문
그리고 그 특성 조건과 설정 구성을 다 공부해야됨.

이걸도와주는게 쿠버네티스
쿠버니티스

### what exactly is kubernetes

배포하는 방식/ 컨테이너 스케일링 / 컨테이너 실패 시 모니터링 방법 교체 시기 정의 가능

우리가 사용하는 클라우드 서비스와는 독립적인 방식으로 정의

컨테이너 배포를 관리하고 컨테이너를 오케스트레이션 하기위한 표준

자동 배포, 스케일링 , 로드밸런싱

배포구성파일 / 컨테이너, 인스턴스 수 , 스케일 확장 교체 등 설정 가능 그리고 이 설정 파일을 프로바이더를 통해 전달.

**생성되어야되고 관리되어야 하는 리소스 설명을 표준화하는 방법**

특정 클라우드 프로바이더에 특화된 옵션 구성을 이 파일을 통해 전달 가능

쿠버네티스는 aws나 azure의 대안이아님 오픈소스프로젝트. 소프트웨어의 모음일뿐

도커의 대안도 아님 같이 움직인다.

다중 기계 설정을 위한 도커 컴포즈 같은게 쿠버니티스 배포용 docker-compose

### 쿠버네티스 아키텍쳐 / 개념

pod라는 것에 의해 관리됨
pod ? => 쿠버네티스 세계에의 가장 작은 단위
pod는 컨테이너를 소유함

포드는 여러개의 컨테이너를 가질수있음

컨테이너가있는 포드는 워커 노드에서 자신을 실해함

워커노드 안에 포드

워커노드? => 가상 인스턴스 / 머신 AWS에서 EC2 인스턴스 느낌 /동일 워커노드중 하나,둘이상의 포드 실행가능

워크노드 안에 프록시와 컨피그가있음

프록시?=> 쿠버네티스가 워커노드의 포드 네트워크 트래픽의 제어를 설정하는 도구

프록시는 기본적으로 포드가 인터넷에 연결할 수 있는지의 여부와 그 내부에서 실행되는 컨테이너를 외부에 어떻게 연결할지 정의함.

포드의 컨테이너에서 외부 트래픽이 컨테이너에 도달할 수 있는 프록시를 구성해야함.

워커노드가없으면 포드와 컨테이너를 실행할 장소가없다.

multiple pods는 스케일에따라 생성되고 삭제될수있음. 워크로드 고르게 분배가능

마스터 노드 안에있는 Control plane의 호출에 의해 제어됨

워커노트와 상호작용하고 제어하는 컨트롤 센터ㅇ

쿠버네티스로 작업할때 워커노드와 포드랑 직접적으로 컨트롤안함 할수도있지만 컨트롤 플레인이 하게 냅둠

마스터 노드 => 단순히 다른 서버, 다른 리모트머신

워커노드가 다운되도 마스터 노드는 다운되지않음

마스터 노드는 다양한서비스 도구의 모음임.

이모든것들이 클러스터를 형성하고 연결된 하나의 네트워크를 형성

마스터 노드는 클라우드 프로바이더 API를 사용해서 이 최종 상태를 복제하도록 지시함.

AWS라고하면 AWS가 필요할수있는 로드밸런서 ec2등등을 생성시킴

### 쿠버네티스는 인프라를 관리하지않음.

클러스터와 워커노드 쿠버네티스가 실행되는 마스터노드를 개발자혹은 관리자가 해야됨

쿠버네티스에 필요한것들을 전부 구성해야됨.

프로바이더에 따라 부가 리소스를 설정해야될수도있음 => 로드밸런서나 특정파일시스템

docker compose가 어려워하는 부분이 쿠버네티스에 준비되어있음

### 워커노드

예를들면 어딘가 실행중인 EC2 같은것임

워커노드 내부에 포드가있음

포드는 하나 이상의 앱 컨테이너와 컨테이너에 속한 모든 리소스를 호스팅함.

컨테이너 설정과 볼륨도 들어있음 그리고 마스터 노드에 의해 관리됨

포드가삭제되면 포드는 내부적으로 포드에 속한 컨테이너를 실행및 관리가능

퐅드 내부에 멀티 컨테이너 가능

워커노드에는또다른 포드가 또있을수도있다 ㅇ 워커노드는 머신이니까 이를 염두해야

워커 노드에는 포드뿐 아니라 추가 소프트웨어도있어야됨 => 도커 ㅇ

도커는 컨테이너를 생성하고 포드에 필요함

그리고 워커노드와 마스터 노드간의 통신장치인 kublet이라는 소프트웨어가 실행됨
kube-proxy가 트래픽을 제어함 허용된 애들 들어오고 허용된 애들만 떠나갈수있도록

### 마스터 노드

마스터 노드는 뭘하고 뭐가실행되는가?

1.  API 서버 워커노드에서 실행되는 kublet서비스에 대한 커뮤니케이션 서비스

2.  스케쥴러 -> 포드를 관찰

3.  kube-controller-manager => 워커노드 관찰 및 관리

4.  cloub-controller-manager => 클라우드 프로바이더에서뭘해야되는지알려줌

### 중요 용어 & 개념

클러스터 : 노드머신, 마스터, 워커노드 모든 최종 상태를 구성하는 컬랙션 세트
노드 : 하나 / 여러개의 포드를 호스팅하는 물리 혹은 가상 머신 / 마스터노드와 워커노드가있음
포드: 실생되는 앱 컨테이너와 그들의 필수 리소스들 (ex 볼륨)
컨테이너 : ㅇ 그냥 도커 컨테이너 / 포드가 내부적으로 docker run을 실행함
Services: 논리적 세트/ 고유 포드 및 컨테이너에 독립적인 IP를 가진 포드 그룹
서비스는 포드에 접근하는데 중요하며 그 안에있는 컨테이너도 중요 => 프록시와 연관이있음
특정 포드를 외부세계에 노출하여 특정 IP 혹은 도메인으로 특정 포드에 연결할수있도록 하는 용어
